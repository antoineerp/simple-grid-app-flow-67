
<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FormaCert</title>
    <link rel="icon" href="/lovable-uploads/formacert-logo.png" type="image/png">
    <meta name="description" content="FormaCert - Système de gestion de certification" />
    
    <!-- Ne définir WS_TOKEN que sur Lovable -->
    <script>
      if (window.location.hostname.includes('lovable.dev') || 
          window.location.hostname.includes('lovable.app') || 
          window.location.hostname.includes('gpteng.co')) {
        window.__WS_TOKEN__ = "lovable-ws-token";
      }
    </script>
    
    <!-- Chargement automatique des assets CSS -->
    <script>
      function loadCSS() {
        fetch('/dist/assets/')
          .then(response => response.text())
          .then(html => {
            const cssPattern = /index[^"']*\.css/;
            const match = html.match(cssPattern);
            if (match) {
              const link = document.createElement('link');
              link.rel = 'stylesheet';
              link.href = '/dist/assets/' + match[0];
              document.head.appendChild(link);
            }
          })
          .catch(error => {
            console.error('Erreur lors du chargement du CSS:', error);
          });
      }
      
      window.addEventListener('DOMContentLoaded', loadCSS);
    </script>
  </head>
  <body>
    <div id="root"></div>
    <noscript>
      <div style="text-align:center; margin-top:50px; font-family:sans-serif;">
        <p>Cette application nécessite JavaScript pour fonctionner.</p>
      </div>
    </noscript>
    
    <!-- Script Lovable -->
    <script src="https://cdn.gpteng.co/gptengineer.js" type="module"></script>
    
    <!-- Chargement automatique du script principal -->
    <script>
      function loadMainScript() {
        fetch('/dist/assets/')
          .then(response => response.text())
          .then(html => {
            const jsPattern = /index[^"']*\.js(?!")/;
            const match = html.match(jsPattern);
            if (match) {
              const script = document.createElement('script');
              script.type = 'module';
              script.src = '/dist/assets/' + match[0];
              document.body.appendChild(script);
            }
          })
          .catch(error => {
            console.error('Erreur lors du chargement du JS:', error);
          });
      }
      
      window.addEventListener('DOMContentLoaded', loadMainScript);
    </script>
    
    <!-- Message d'erreur en cas d'échec de chargement -->
    <script>
      setTimeout(() => {
        if (document.getElementById('root').childElementCount === 0) {
          document.getElementById('root').innerHTML = `
            <div style="max-width:800px; margin:50px auto; padding:20px; font-family:sans-serif; line-height:1.5; color:#333; background:#f9f9f9; border:1px solid #ddd; border-radius:8px;">
              <h1 style="color:#d33;">Erreur de chargement de l'application</h1>
              <p>L'application n'a pas pu être chargée correctement.</p>
              <h3>Diagnostic :</h3>
              <ul>
                <li>Vérifiez que les fichiers d'assets sont présents dans le dossier /dist/assets/</li>
                <li>Assurez-vous que le build a été effectué correctement</li>
              </ul>
            </div>
          `;
        }
      }, 5000);
    </script>
  </body>
</html>
