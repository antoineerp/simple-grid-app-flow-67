
# Enable rewrite engine
RewriteEngine On
RewriteBase /

# Simple PHP handler configuration
AddType application/x-httpd-php .php
AddHandler application/x-httpd-php .php

# Force PHP execution
<FilesMatch "\.php$">
    SetHandler application/x-httpd-php
</FilesMatch>

# Explicitly allow access to diagnostic PHP files
<Files "deploy-timestamp.php">
    Order allow,deny
    Allow from all
</Files>

<Files "verify-deploy.php">
    Order allow,deny
    Allow from all
</Files>

<Files "deploy-check.php">
    Order allow,deny
    Allow from all
</Files>

<Files "check-php-assets.php">
    Order allow,deny
    Allow from all
</Files>

# Make sure specific PHP files are accessible directly
RewriteRule ^deploy-timestamp\.php$ deploy-timestamp.php [L,PT]
RewriteRule ^verify-deploy\.php$ verify-deploy.php [L,PT]
RewriteRule ^deploy-check\.php$ deploy-check.php [L,PT]
RewriteRule ^check-php-assets\.php$ check-php-assets.php [L,PT]

# Redirect API requests to the API folder
RewriteRule ^api(/.*)?$ api$1 [L]

# Default behavior: React routing through index.html
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(?!api/) index.html [L]
