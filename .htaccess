
# Enable rewrite engine
RewriteEngine On
RewriteBase /

# Forcer l'exécution de PHP - SECTION CRITIQUE
AddHandler application/x-httpd-php .php
AddType application/x-httpd-php .php

# Authorisation explicite pour tous les fichiers PHP dans la racine
<FilesMatch "\.php$">
    SetHandler application/x-httpd-php
    Order allow,deny
    Allow from all
</FilesMatch>

# Cas particuliers d'accès direct aux fichiers PHP
<Files "deploy-timestamp.php">
    Order allow,deny
    Allow from all
</Files>

<Files "verify-deploy.php">
    Order allow,deny
    Allow from all
</Files>

<Files "deploy-check.php">
    Order allow,deny
    Allow from all
</Files>

<Files "check-php-assets.php">
    Order allow,deny
    Allow from all
</Files>

<Files "index-fixer.php">
    Order allow,deny
    Allow from all
</Files>

# Redirection API vers le dossier API
RewriteRule ^api(/.*)?$ api$1 [L]

# Par défaut: le routage React via index.html
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(?!api/) index.html [L]
