
# Configuration pour assurer l'exécution PHP
RewriteEngine On
RewriteBase /

# Activer le moteur de réécriture
Options +FollowSymLinks

# Force l'exécution des scripts PHP - TRÈS IMPORTANT
<FilesMatch "\.php$">
    SetHandler application/x-httpd-php
</FilesMatch>

# S'assurer que mod_php est bien utilisé
AddType application/x-httpd-php .php
AddHandler application/x-httpd-php .php

# Configurer explicitement le module PHP (si disponible)
<IfModule mod_php.c>
    php_flag display_errors on
    php_value error_reporting 32767
    php_flag output_buffering on
</IfModule>

# Rediriger les requêtes API vers le dossier api
RewriteRule ^api(/.*)?$ api$1 [L]

# Rediriger toutes les autres requêtes vers index.html pour le routage React
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(?!api/) index.html [L]

# Index par défaut
DirectoryIndex index.html index.php

# Configuration UTF-8
AddDefaultCharset UTF-8

# Désactiver la mise en cache pour les fichiers PHP
<FilesMatch "\.php$">
    Header set Cache-Control "no-cache, no-store, must-revalidate"
    Header set Pragma "no-cache"
    Header set Expires "0"
</FilesMatch>
